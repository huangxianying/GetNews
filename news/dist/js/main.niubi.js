var app=angular.module("newsApp",["ui.router","ng.post","news.controller","news.service","news.directive"]);app.config(function(e){e.state("index",{url:"/index",templateUrl:"template/index.html",controller:"indexCtrl"}).state("index.list",{url:"/list",templateUrl:"template/newsList.html",controller:"listCtrl"}).state("index.login",{url:"/login",templateUrl:"template/login.html",controller:"loginCtrl"}).state("detail",{url:"/detail/:id",templateUrl:"template/detail.html",controller:"detailCtrl"}).state("login",{url:"/login",templateUrl:"template/logins.html",controller:"loginsCtrl"}).state("register",{url:"/register",templateUrl:"template/register.html",controller:"registerCtrl"}).state("setting",{url:"/setting",templateUrl:"template/setting.html",controller:"settingCtrl"})}),function(){var e=angular.module("news.controller",[]);e.controller("indexCtrl",["$scope","$rootScope","$http","cookie",function(e,n,o,t){var l=t.getCookie("token"),i=t.getCookie("username");o.post("http://localhost/htmldocument/1201/day9/newsqianduan/news/index.php/login_api/auto_login",{params:{token:l,username:i}}).success(function(e){console.log(e),e.code||(window.location.href="#/login")}),e.tabs=[{name:"国内最新",id:1,url:"#/index/list"},{name:"游戏焦点",id:2,url:"#/index/login"},{name:"登录",id:3,url:"#/index/login"}],n.id=1,e.toggleTab=function(e){console.log(e),n.id=e}}]),e.controller("listCtrl",["$scope","$http",function(e,n){e.isShowSwiper=!0,e.page=1,e.isShow=!1,e.news=[];var o=function(){n.jsonp("news.php",{params:{page:e.page,channelId:"5572a109b3cdc86cf39001db",channelName:"国内最新",callback:"JSON_CALLBACK"}}).success(function(n){e.isShow=!0,console.log(n),e.news=e.news.concat(n.showapi_res_body.pagebean.contentlist)})};o(),e.searchName="",e.isSearch=!1,e.search=function(){e.isSearch=!0},e.cancelSearch=function(){e.isSearch=!1},e.loadMore=function(){e.isShow=!1,e.page++,o()}}]),e.controller("loginCtrl",["$scope","$http","$rootScope",function(e,n,o){e.isShowSwiper=!0,o.id=2,e.page=1,e.isShow=!1,e.news=[];var t=function(){n.jsonp("news.php",{params:{page:e.page,channelId:"5572a108b3cdc86cf39001d6",channelName:"游戏焦点",callback:"JSON_CALLBACK"}}).success(function(n){e.isShow=!0,console.log(n),e.news=e.news.concat(n.showapi_res_body.pagebean.contentlist)})};t(),e.searchName="",e.isSearch=!1,e.search=function(){e.isSearch=!0},e.cancelSearch=function(){e.isSearch=!1},e.loadMore=function(){e.isShow=!1,e.page++,t()}}]),e.controller("detailCtrl",["$scope","$http","$state",function(e,n,o){e.isShowGallery=!1,e.showGallery=function(n,o){e.isShowGallery=n,console.log(o),e.imgUrl="background-image:url("+o+")"},console.log(o.params),n.jsonp("news.php",{params:{page:1,channelId:"5572a109b3cdc86cf39001db",channelName:"国内最新",callback:"JSON_CALLBACK"}}).success(function(n){console.log(n),e.new=n.showapi_res_body.pagebean.contentlist[o.params.id],console.log(e.new)})}]),e.controller("loginsCtrl",["$scope","$http","cookie",function(e,n,o){e.login=function(){console.log("username:"+e.username),console.log("password:"+e.password),n.post("http://localhost/htmldocument/1201/day9/newsqianduan/news/index.php/login_api/login",{params:{username:e.username,password:e.password}}).success(function(e){console.log(e),e.code&&(o.setCookie("token",e.info.token),o.setCookie("username",e.username),window.location.href="#/index/list")})}}]),e.controller("registerCtrl",["$scope","$http","cookie",function(e,n,o){e.register=function(){console.log("username:"+e.username),console.log("password:"+e.password),n.post("http://localhost/htmldocument/1201/day9/newsqianduan/news/index.php/login_api/register",{params:{username:e.username,password:e.password}}).success(function(e){console.log(e),e.code&&(o.setCookie("username",e.username),o.setCookie("token",e.info.token),window.location.href="#/index/list")})}}]),e.controller("settingCtrl",["$scope","$http","cookie",function(e,n,o){var t=o.getCookie("token"),l=o.getCookie("username");n.post("http://localhost/htmldocument/1201/day9/newsqianduan/news/index.php/login_api/auto_login",{params:{token:t,username:l}}).success(function(e){console.log(e),e.code||(window.location.href="#/login")})}])}(),function(){var e=angular.module("news.directive",[]);e.directive("newsList",[function(){return{templateUrl:"directive/newsList.html"}}]),e.directive("searchBar",[function(){return{templateUrl:"directive/searchBar.html"}}]),e.directive("swiper",[function(){return{templateUrl:"directive/swiper.html",link:function(e,n,o){new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0})}}}])}(),function(){var e=angular.module("news.service",[]);e.service("cookie",["$document",function(e){return{setCookie:function(n,o){var t=10,l=new Date;l.setTime(l.getTime()+24*t*60*60*1e3),e[0].cookie=n+"="+o+";expires="+l},getCookie:function(n){var o,t=new RegExp("(^|)"+n+"=([^;]*)(;|$)");if(o=e[0].cookie.match(t))return o[2]}}}])}();